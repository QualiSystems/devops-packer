---
driver:
    name: hyperv
    vm_generation: 2
    disable_secureboot: true
    enable_guest_services: true
    memory_startup_bytes: 2147483648
    dynamic_memory: true

provisioner:
  name: chef_zero
  roles_path: '../roles'

transport:
  name: ssh
  elevated: true
  password: 'vagrant'
  username: 'vagrant'

platforms:
  - name: ubuntu-17.04
    os_type: unix
    driver:
        parent_vhd_folder: '../../.output/hyperv/ubuntu1704/Virtual Hard Disks'
        parent_vhd_name: 'ubuntu1704.vhdx'

verifier:
      name: inspec

suites:
  - name: common
    run_list:
#      - recipe[packer-ubuntu::install_hyperv_integration_services]
#      - recipe[packer-ubuntu::configure_ssh]
#      - recipe[packer-ubuntu::add_vagrant_ssh_key]
#      - recipe[packer-ubuntu::set_time_zone]
#      - recipe[packer-ubuntu::purge_apt_packages]
#      - recipe[packer-ubuntu::delete_redundant_files]       
      - recipe[packer-ubuntu::install_xfce_desktop]
      - recipe[packer-ubuntu::configure_x_to_use_xfce]
      - recipe[packer-ubuntu::install_xrdp]
#      - recipe[packer-ubuntu::configure_xrdp_to_use_xfce]
#      - role[xfce_desktop]
#      - role[xrdp_xfce]
    attributes:
        box_settings:
            is_desktop: "false"
            time_zone: 'Asia/Jerusalem'
            ssh_user: 'vagrant'
            ssh_user_password: 'vagrant'
            ssh_user_group: 'vagrant'